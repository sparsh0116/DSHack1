<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/css/style.css">
    <title>Oasis</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
</head>

<body>

    <!-- Navbar -->

    <header class="p-3 fixed-top text-bg-dark">
        <div class="container">
            <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
                <a class="navbar-brand" href="#" style="color: #F5E8C7; font-size: 2rem; font-weight: bold;">
                    Oasis
                </a>

                <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                    <li><a href="#" class="nav-link px-2 text-secondary" style="margin-left: 2rem;">Home</a></li>
                    <li><a href="#" class="nav-link px-2 text-white">About</a></li>
                    <li><a href="#" class="nav-link px-2 text-white">Contact Us</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false" style="color: #F5E8C7;">
                            Shop
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Buy</a></li>
                            <li><a class="dropdown-item" href="#">Sell</a></li>
                            <li><a class="dropdown-item" href="#">Rent</a></li>
                            <li><a class="dropdown-item" href="#">Cart</a></li>
                            <li><a class="dropdown-item" href="#">Orders</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item disabled" href="#">Sign Out</a></li>
                        </ul>
                    </li>
                </ul>

                <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search">
                    <input type="search" class="form-control form-control-dark text-bg-dark" placeholder="Search..."
                        aria-label="Search">
                </form>

                <div class="text-end">
                    <a href="/login" id="join"></a>   
                </div>
            </div>
        </div>
    </header>


    <!-- carousel -->

    <div id="carouselExampleControls" class="carousel slide carousel-fade" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="/static/img/11.jpg" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="/static/img/22.jpg" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="/static/img/33.jpg" class="d-block w-100" alt="...">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls"
            data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>


    <!-- products -->


    <div class="row my-3 mx-3">
        <div class="col-2">
          <div id="list-example" class="list-group">
            <a class="list-group-item list-group-item-action" href="#list-item-1">Bestsellers</a>
            <a class="list-group-item list-group-item-action" href="#list-item-2">English books</a>
            <a class="list-group-item list-group-item-action" href="#list-item-3">Hindi books</a>
            <a class="list-group-item list-group-item-action" href="#list-item-4">Tamil books</a>
            <a class="list-group-item list-group-item-action" href="#list-item-4">Telugu books</a>
          </div>
        </div>
        <div class="col-8">
          <div data-bs-spy="scroll" data-bs-target="#list-example" data-bs-smooth-scroll="true" class="scrollspy-example" tabindex="0">
            <h2 id="list-item-1">Bestsellers</h2>
            <p>...</p>
            <h2 id="list-item-2">English</h2>
            <p>...</p>
            <h2 id="list-item-3">Hindi</h2>
            <p>...</p>
            <h2 id="list-item-4">Tamil</h2>
            <p>...</p>
            <h2 id="list-item-4">Telugu</h2>
            <p>...</p>
          </div>
        </div>
      </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>
</body>

<script>
    const navbar_join = document.getElementById('join')

        current_user = {{ current_user_id | tojson}}
        console.log(typeof current_user)

        var id_json

        function data_read(){
            var xhr = new XMLHttpRequest()
            xhr.open('GET', '/static/json/user_id.json', true)
        
            xhr.onload = function () {
                jsondata = JSON.parse(this.responseText)
        
                id_json = jsondata
            }
            xhr.send()
            return 0
        }

        async function data_load() {
            const id_data = await data_read()
            const mytimeout = setTimeout(rundata, 2000)
        }

        function rundata() {
            console.log(id_json)
            navbar_join.innerHTML = `<a  style='font-weight: 1000;font-size: 20px;'> ${id_json[current_user]["user_name"]}
                                     <img src="${id_json[current_user]["user_dp"]}" style='border-radius: 50%;height: 32px;width: 32px;margin-left:6px'></a>`
        }


        if( current_user == "not_defined") {
            navbar_join.innerHTML = `<button href="/login" class="btn btn-primary ms-lg-3" style="border-radius: 15px 15px 15px 15px ;border:5px">Join Us</button>`
        }
        else {
            data_load()
        }

</script>

</html>